<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://unpkg.com/tabulator-tables@5.2.3/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <style>
      body{
      background-color:#fff;
      }
    </style>
  <body>
    <div id="data-table"></div>
    <div id="alerts"></div>
    <div id="example-table-theme"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/2.4.0/luxon.min.js" integrity="sha512-v1zUTZ9zv9Wb2scL/ANxXM6m7yegm/W5SN8SRHNFADdZIuSFFkrEBjNxO803DdFkjoCcJ88g1WHRVlLN6K/O1A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/2.4.0/luxon.js" integrity="sha512-mG5s2PtixGEVGHGdHEP/t09HMp5LS4O7tGSveeGniCbzeZKIxsPdmExeabz8xmxcSe+wfYvSMbe6G2c3d9ZQXQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.2.3/dist/js/tabulator.min.js"></script>
    <script>
      // http://tabulator.info/
      const elements = {}
      document.addEventListener("DOMContentLoaded",pageLoad)

      function pageLoad(){
        elements.alerts = document.getElementById("alerts")
        loadData()
      }



      function loadData(){
        google.script.run
        .withSuccessHandler((jsData) => {

          const table = new Tabulator("#data-table", {
            // if data successfully
            data:jsData, //assign data to table
            layout:"fitColumns", //fit columns to width of table (optional)
            //pagination:true,
            //paginationSize:8,
            columnDefaults:{
              hozAlign:"center",
              headerHozAlign:"center",
              headerSort:true
            },
            columns:[ //Define Table Columns
              {
                title: "Team Info",
                columns: [
                  {title:"Seed", field:"Seed", headerSort:true, width:75},
                  {title:"Team", field:"Team", headerSort:false, width:175},
                ],
              },
              {
                title: "Averages",
                columns: [
                  {title:"Kills", field:"AVG Kills", headerSort:true},
                  {title:"Deaths", field:"AVG Deaths", headerSort:true},
                  {title:"Assists", field:"AVG Assists", headerSort:true},
                  {title:"Game Time", field:"AVG Game Time", headerSort:true, width:125},
                ],
              },
              {
                title: "Totals",
                columns: [
                  {title:"Dragons", field:"Total Dragons", headerSort:true},
                  {title:"Heralds", field:"Total Heralds", headerSort:true},
                  {title:"Barons", field:"Total Barons", headerSort:true},
                  {title:"Towers", field:"Total Towers", headerSort:true},
                ],
              },
            ],
          })


        })// end of SuccessHandler for jsData
        .withFailureHandler((er) => {

        })// end of SuccessHandler for jsData
        .getData()
      }


    </script>
  </body>
</html>
